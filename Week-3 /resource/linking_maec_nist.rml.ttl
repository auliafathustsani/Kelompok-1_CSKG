@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix maec: <http://example.org/ontology/malware-action#> .
@prefix sec: <http://example.org/ontology/security-link#> .
@base <http://example.org/malware/linking/> .

# Triples Map untuk menautkan Aksi Malware ke Kontrol NIST
<#MAEC_NIST_Link>
  a rr:TriplesMap;

  # Logical Source: Membaca file data MAEC
  rml:logicalSource [
    rml:source "malware-action-data-another.json"; 
    rml:referenceFormulation ql:JSONPath;
    # Hanya fokus pada entitas Malware Action
    rml:iterator "$" 
  ];
  
  # Subject Map: Malware Action (ma-001)
  rr:subjectMap [
    rr:template "http://example.org/malware/action/{id}";
    rr:class maec:MalwareAction
  ];
  
  # Predicate-Object Map: Menghubungkan Aksi ke Kontrol NIST
  rr:predicateObjectMap [
    rr:predicate sec:isMitigatedBy;
    
    # Object Map: Hanya memetakan jika nama aksi adalah 'WriteFile'
    rr:objectMap [
      # Logika sederhana: Jika 'name' di data = 'WriteFile', maka output URI AC-3
      # Dalam implementasi RML yang kompleks, ini menggunakan fungsi kondisi (misalnya FnO)
      # Untuk simplifikasi, kita akan menggunakan 'name' untuk membuat koneksi:
      rml:reference "name"; 
      
      # Kita buat template Objek, yang harus cocok dengan IRI di NIST_kg_output.ttl
      rr:template "http://example.org/nist80053/control/ac-3"; 
      rr:termType rr:IRI;
      
      # ***Kondisi Opsional (Jika RML Mapper mendukung):***
      # rml:condition "[name] = 'WriteFile'" 
    ]
  ].