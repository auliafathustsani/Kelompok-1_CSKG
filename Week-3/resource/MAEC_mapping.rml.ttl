@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

@prefix maec: <http://example.org/ontology/malware-action#> .
@base <http://example.org/malware/mapping/> .

# =================================================================
# Triples Map 1: Malware Action (maec:MalwareAction)
# =================================================================
<#MalwareActionMap>
  a rr:TriplesMap;

  # PERHATIAN: Ganti [nama_file_data_anda].json dengan nama file data Anda yang sebenarnya!
  rml:logicalSource [
    rml:source "malware-action-data-another.json"; 
    rml:referenceFormulation ql:JSONPath;
    # PERBAIKAN: Mengasumsikan objek Malware Action adalah elemen root, atau hanya ada satu objek.
    rml:iterator "$" 
  ];

  # ... (Bagian Subject & Predicate Maps lainnya SAMA) ...
  rr:subjectMap [
    rr:template "http://example.org/malware/action/{id}";
    rr:class maec:MalwareAction
  ];
  # ... (Mapping properti literal lainnya) ...

  # Referensi: API Call
  rr:predicateObjectMap [
    rr:predicate maec:invokesAPICall;
    rr:objectMap [
      rr:parentTriplesMap <#APICallMap>; 
      rr:template "http://example.org/malware/api/{api_call.name}"; # Menggunakan 'name' di objek api_call
      rr:termType rr:IRI
    ]
  ];
  
  # Referensi: Input Objects
  rr:predicateObjectMap [
    rr:predicate maec:hasInput; 
    rr:objectMap [
      rml:reference "input_object_refs[*]"; 
      rr:template "http://example.org/malware/object/{input_object_refs[*]}";
      rr:termType rr:IRI
    ]
  ];

  # Referensi: Output Objects
  rr:predicateObjectMap [
    rr:predicate maec:hasOutput; 
    rr:objectMap [
      rml:reference "output_object_refs[*]"; 
      rr:template "http://example.org/malware/object/{output_object_refs[*]}";
      rr:termType rr:IRI
    ]
  ].


# =================================================================
# Triples Map 2: API Call (maec:APICall)
# =================================================================
<#APICallMap>
  a rr:TriplesMap;

  # 1. Logical Source: Menggunakan iterator yang sama
  rml:logicalSource [
    rml:source "malware-action-data-another.json";
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$" 
  ];

  # 2. Subject Map: Membuat IRI API Call dari properti bersarang
  rr:subjectMap [
    rr:template "http://example.org/malware/api/{api_call.name}"; # Menggunakan api_call.name
    rr:class maec:APICall
  ];

  # 3. Predicate-Object Maps (Properti dari objek api_call)
  rr:predicateObjectMap [
    rr:predicate rdfs:label;
    rml:reference "api_call.name"
  ];
  
  rr:predicateObjectMap [
    rr:predicate maec:hasDescription;
    rml:reference "api_call.description" # Diasumsikan ada 'description' di dalam api_call
  ].