@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix maec: <http://example.org/ontology/malware-action#> .
@prefix ti: <http://example.org/ontology/threat-intelligence#> .
@base <http://example.org/threat/linking/> .

# Triples Map untuk menautkan Aksi Malware ke Feed MISP
<#MAEC_MISP_Link>
  a rr:TriplesMap;

  # Logical Source: Membaca file data MAEC
  rml:logicalSource [
    rml:source "malware-action-data-another.json"; 
    rml:referenceFormulation ql:JSONPath;
    rml:iterator "$" 
  ];
  
  # Subject Map: Malware Action (ma-001)
  rr:subjectMap [
    rr:template "http://example.org/malware/action/{id}";
    rr:class maec:MalwareAction
  ];
  
  # Predicate-Object Map: Menghubungkan Aksi ke Feed MISP
  rr:predicateObjectMap [
    rr:predicate ti:hasObservedIndicator;
    
    # Object Map: Hardcode link ke URI Feed MISP yang sesuai
    rr:objectMap [
      # Ambil URI Feed ELLIO dari MISP_kg_output.ttl
      rr:template "http://example.org/resource/feed/https%3A%2F%2Fcdn.ellio.tech%2Fcommunity-feed"; 
      rr:termType rr:IRI
    ]
  ].